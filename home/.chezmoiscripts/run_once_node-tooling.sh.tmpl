#!/bin/bash
set -euo pipefail

{{ $enableNode := or (eq .profile "work") (eq .profile "personal") -}}

{{- if (and (eq .chezmoi.os "linux") $enableNode) -}}

echo "==> Node tooling setup"

if command -v npm >/dev/null 2>&1; then
  echo "-> Enabling corepack"
  npm install --global corepack@latest

  if command -v corepack >/dev/null 2>&1; then
    echo "-> Enabling pnpm via corepack"
    corepack enable pnpm
  fi

  echo "[TODO] After first initialization, run: nvm install --lts"
else
  echo "-> npm not found, skipping corepack/pnpm"
fi

echo "==> Node tooling setup done"

{{- end -}}
